<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>企业管理</title>
    <!--[if lt IE 9]>
    <script src='resources/js/assets/javascripts/html5shiv.js' type='text/javascript'></script>
    <![endif]-->
    <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no'
        name='viewport' />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type' />
    <link type='text/css' rel='stylesheet' href='resources/js/assets/stylesheets/bootstrap/bootstrap.css'
        media='all' />
    <link type='text/css' rel='stylesheet' href='resources/js/assets/stylesheets/light-theme.css'
        id='color-settings-body-color' media='all' />
    <link type='text/css' rel='stylesheet' href='resources/js/assets/stylesheets/demo.css'
        media='all' />
    <link type='text/css' rel='stylesheet' href='resources/js/jqgrid/css/jquery-ui.css'
        media='screen' />
    <link type='text/css' rel='stylesheet' href='resources/js/jqgrid/css/ui.jqgrid.css'
        media='screen' />
    <link type='text/css' rel='stylesheet' href='resources/js/jqgrid/css/prettify.css' />
    <link type='text/css' rel='stylesheet' href='console/css/ystep.css' />
    <link type='text/css' rel='stylesheet' href='console/css/css.css' media='all' />
    <script type='text/javascript' src='resources/js/assets/javascripts/jquery/jquery.min.js'></script>
    <script type="text/ecmascript" src="resources/js/jqgrid/js/jquery.jqGrid.min.js"></script>
    <script type="text/ecmascript" src='resources/js/jqgrid/js/prettify.js'></script>
    <script type="text/ecmascript" src='resources/js/jqgrid/js/codetabs.js'></script>
    <script type="text/ecmascript" src='resources/js/jqgrid/js/themeswitchertool.js'></script>
    <script type="text/ecmascript" src='resources/js/jqgrid/js/i18n/grid.locale-cn.js'></script>
    <script type="text/ecmascript" src='resources/js/My97DatePicker/WdatePicker.js'></script>
    <script type='text/javascript' src='GetJS?button.js'></script>
    <script type='text/javascript' src="GetJS?messagebox.js"></script>
    <script type='text/javascript' src='GetJS?combobox.js'></script>
    <script type='text/javascript' src="GetJS?dataform.js"></script>
    <script type='text/javascript' src="GetJS?popupwindow.js"></script>
    <script type='text/javascript' src='GetJS?js/ystep.js'></script>
    <script type='text/javascript' src='console/js/public.js'></script>
    <script type='text/javascript' src='GetJS?js/checkradio.js'></script>
</head>
<body class='contrast-red' style="padding-left: 5px;">
    <div class='row-fluid' id='content-wrapper'>
        <div class='span12'>
           <!--  <div class='row-fluid'>
                <div class='span12'>
                    <div class='page-header'>
                        <h1 class='pull-left'>
                            <i class='icon-table'></i><span>企业管理</span>
                        </h1>
                        <div class='pull-right'>
                            <ul class='breadcrumb'>
                                <li><i class='icon-bar-chart'></i></li>
                                <li class='separator'><i class='icon-angle-right'></i></li>
                                <li class='separator'>系统管理</li>
                                <li class='separator'><i class='icon-angle-right'></i></li>
                                <li class='separator'>企业管理</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div> -->
            <div class='row-fluid'>
                <div class='span12 box bordered-box orange-border' style='margin-bottom: 0;'>
                    <div class='row-fluid'>
                        <div class='span12 box'>
                            <!-- <div class='box-header blue-background'>
	                            <div class='pull-left'>
		                            <ul class='breadcrumb' style='padding: 5px;'>
	                            	<li><i class='icon-table'></i><span>企业管理</span></li>
	                            	</ul>
		                        </div>
		                        <div class='pull-right' style="font-size:12px">
		                            <ul class='breadcrumb' style='padding: 0px;'>
		                                <li><i class='icon-bar-chart'></i></li>
		                                <li class='separator'>系统管理</li>
		                                <li class='separator'><i class='icon-angle-right'></i></li>
		                                <li class='separator'>企业管理</li>
		                            </ul>
		                        </div>
                                <div class='title'>
                                    <div class='icon-edit'>
                                    </div>
                                    基本查询信息</div>
                            </div> -->
                            <div class='box-content' style="margin-right: 13px;">
                                <table width="100%" border="0" cellspacing="0" cellpadding="0" style="margin-bottom: 10px;
                                    border-bottom: 1px solid #114;">
                                    <tr>
                                        <td style="text-align: left; padding-right: 10px; padding-left: 10px;">
	                                       	 <div class="btn-group">
                                            <button class='btn btn-primary btn-small' id="btnSoEnt" style='margin-bottom: 5px'>
                                                <i class='icon-search'></i>查 询
                                            </button>
                                            <button class='btn btn-primary btn-small' onclick="ClearAllInput('SearchTable')"
                                                style='margin-bottom: 5px;margin-left: 5px'>
                                                <i class='icon-trash'></i>重 置
                                            </button>
                                            <button id="btnNew" class='btn btn-primary btn-small' style='margin-bottom: 5px;margin-left: 5px'
                                                onclick="javascript:location.href='GetHTML?auth/EdsEntEdit.html'">
                                                <i class='icon-file'></i>新 建
                                            </button>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                                <table width="100%" border="0" cellspacing="0" cellpadding="0" id="SearchTable">
                                    <tr>
                                        <td style="width: 50%; padding: 2px;">
                                            <table width="100%" border="0" cellspacing="0" cellpadding="0" >
                                                <tr>
                                                    <td class="titleCss90">
                                                        企业名称中文
                                                    </td>
                                                    <td class="tdCss">
                                                        <input id='txtENT_CODE' type='text' style="width: 100%;" datafield="SearchTable.COMPANYNAME"
                                                            startval="%" endval="%" />
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                         <input id='txtIsRoot' type="hidden" style="width: 100%;" datafield="IsRootData.Is_Root"/>
                                        <td style="width: 50%; padding: 2px;">
                                            <table width="100%" border="0" cellspacing="0" cellpadding="0" >
                                                <tr>
                                                    <td class="titleCss90">
                                                        组织机构代码
                                                    </td>
                                                    <td class="tdCss">
                                                        <input id='txtENT_CNAME' type='text' style="width: 100%;" datafield="SearchTable.ORGCODE"
                                                            startval="%" endval="%" />
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class='responsive-table'>
                        <table id="jg">
                        </table>
                        <div id="jqGridPager">
                        </div>
                    </div>
                    <!--</div>-->
                </div>
            </div>
        </div>
</body>
</html>
<script type="text/javascript">

function InitPage() {
	inputForm = "IsRootData";
	postData("../EdsAuth.GetIsRoot", "", true, initok, onerror);
       /* DoCommand("../EdsAuth.GetIsRoot");
       var IsRoot=$("#txtIsRoot").val();
       if(IsRoot!="Y"){
    	   $("#btnNew").hide();
       }*/
}

function initok(s){
	var v = eval("(" + s + ")");
    if (v.IsOk == "1") {
        if(v.ReturnData!="Y"){
     	   $("#btnNew").hide();
     	   $("#txtENT_CNAME").attr("disabled",true);
        }
    }
}

$(document).ready(function () {
        window.onresize = function () {
            setGridSize("#jg",168);
        }
        $("#jg").jqGrid({
            datatype: "json",
            url: "../EdsAuth.GetEntList",
            postData: {
                
            }, 
            colNames: ['企业名称中文', 'ID', '企业名称英文', '企业简称', '组织机构代码', '公司传真', '报检注册号', '所属机构代码', '所属机构名称', '工商营业执照号码', '工商注册日期', '企业性质', '企业邮箱', '法人', '法人电话', '联系人', '联系人手机号码', '经办人姓名', '经办人身份证号', '海关注册代码', '业务类型', '主管检验检疫机构'],
            colModel: [
        	            { name: 'COMPANYNAME', index: 'COMPANYNAME', width:200, formatter: urlCode },
						{ name: 'INDX', index: 'INDX', width: 10 },
                        { name: 'COMPANYENAME', index: 'COMPANYENAME', width: 200 },
						{ name: 'COMPANYSNAME', index: 'COMPANYSNAME', width: 200 },
        	            { name: 'ORGCODE', index: 'ORGCODE', width: 150 },
        	            { name: 'COMPANYFAX', index: 'COMPANYFAX', width: 150 },
						{ name: 'INSPREGNUMBER', index: 'INSPREGNUMBER', width: 200 },
						{ name: 'SUBORGCODE', index: 'SUBORGCODE', width: 200 },
						{ name: 'SUBORGNAME', index: 'SUBORGNAME', width: 200 },
						{ name: 'LICENSENUMBER', index: 'LICENSENUMBER', width: 200 },
						{ name: 'RECORDDATE', index: 'RECORDDATE', width: 100, formatter: "date", formatoptions: { newformat: 'Y-m-d'} },
                        { name: 'COMPANYTYPENAME', index: 'COMPANYTYPENAME', width: 100 },
                        { name: 'COMPANYEMAIL', index: 'COMPANYEMAIL', width: 100 },
                        { name: 'LEGALPERSON', index: 'LEGALPERSON', width: 100 },
                        { name: 'LEGALPERSONTEL', index: 'LEGALPERSONTEL', width: 100 },
                        { name: 'LINKMAN', index: 'LINKMAN', width: 100 },
                        { name: 'LINKMANTEL', index: 'LINKMANTEL', width: 100 },
                        { name: 'AGENTNAME', index: 'AGENTNAME', width: 100 },
                        { name: 'AGENTIDCARD', index: 'AGENTIDCARD', width: 100 },
                        { name: 'CUSTOMSREGCODE', index: 'CUSTOMSREGCODE', width: 100 },
                        { name: 'BUSINESSTYPE', index: 'BUSINESSTYPE', width: 100 },
                        { name: 'INSTITUTIONS_NAME', index: 'INSTITUTIONS_NAME', width: 100 }
        	        ],
            viewrecords: true, // show the current page, data rang and total records on the toolbar
            width: 500,
            //autowidth:auto,
            height: window.screen.height-405,
            shrinkToFit: false,
            autoScroll: false,
            rowNum: 15, //每页显示记录数
            //datatype: 'local',
            rowList: [10, 20, 100], //可调整每页显示的记录数
            rownumbers: true,
            rownumWidth: 35,
//            multiselect: true, //是否支持多选 
            viewrecords: true, //是否显示行数 
            //shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
            pager: "#jqGridPager", //分页工具栏
            altRows: true,
            altclass: 'someClass',
            loadui: "none", //隐藏默认的loading    
            //排序开始
            onSortCol: function (colName, Id, sortorder) {
                //colName   排序字段
                //Id   第几列
                //sortorder  排序  desc 倒序  asc 正序
                $("#jg").jqGrid('setGridParam', {
                    url: "../EdsAuth.GetEntList",
                    postData: {
                        'OrderField': colName,
                        'Order': sortorder,
                        'CommandData': FormToData('SearchTable')
                    }, //发送数据 
                    page: 1
                }).trigger("reloadGrid"); //重新载入 
            },
            //排序结束
            // loadonce : true,
            //caption: "**Data",
            sortable: true,
            loadComplete: function () {
                var rowNum = $(this).jqGrid('getGridParam', 'records');
                if (rowNum <= 0) {
                    if ($(this).parent().children('.norecords').length == 0)
                        $(this).parent().append("<div class=\"norecords\">暂无数据！</div>");
                    $(this).parent().children('.norecords').show();
                }
                else {//如果存在记录，则隐藏提示信息。
                    $(this).parent().children('.norecords').hide();
                }
            }
            ,
            beforeRequest: function () {
                if (top.showloading) {
                    top.showloading();
                }
            },
            gridComplete: function () {
                if (top.hideloading) {
                    top.hideloading();
                }
            }
        });

        setGridSize("#jg",168);

        //显示某一列
        //$("#grid_id").setGridParam().showCol("colname").trigger("reloadGrid");
        //隐藏某一列
        //$("#grid_id").setGridParam().hideCol("colname").trigger("reloadGrid");
        $("#jg").setGridParam().hideCol("INDX").trigger("reloadGrid");
        //查询
        $("#btnSoEnt").click(function () {
            $("#jg").jqGrid('setGridParam', {
                url: "../EdsAuth.GetEntList",
                postData: {
                    'CommandData': FormToData('SearchTable')
                }, //发送数据 
                page: 1
            }).trigger("reloadGrid"); //重新载入 
        });

        //alert(GetInitJson());
    });

    function urlCode(cellvalue, options, rowObject) {
    	var detail_uri = "GetHTML?auth/EdsEntEdit.html";
    	return "<a href="+detail_uri+"?INDX="+rowObject.INDX + "&CELLVALUE=" + cellvalue+"'><span style='color:#00acec'>" + cellvalue + "</a>";
    }
</script>